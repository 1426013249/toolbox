<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•æ„Ÿä¿¡æ¯è„±æ• â€” å›¾ç‰‡æ–‡å­—ä¸€é”®é®æŒ¡ | ToolBox</title>
    <meta name="description" content="å…è´¹åœ¨çº¿æ•æ„Ÿä¿¡æ¯è„±æ•å·¥å…·ã€‚ä¸€é”®é®æŒ¡å›¾ç‰‡ä¸­çš„å§“åã€èº«ä»½è¯å·ã€æ‰‹æœºå·ç­‰éšç§æ•°æ®ã€‚æ•°æ®ä¸å‡ºæœ¬åœ°ã€‚">
    <meta name="keywords" content="æ•æ„Ÿä¿¡æ¯è„±æ•,éšç§é®æŒ¡,é©¬èµ›å…‹å·¥å…·,å›¾ç‰‡æ‰“ç ,èº«ä»½è¯é®æŒ¡,æ‰‹æœºå·é®æŒ¡,æœ¬åœ°å¤„ç†">
    <link rel="canonical" href="https://toolbox-smoky.vercel.app/src/tools/redactor/index.html">
    <meta property="og:title" content="æ•æ„Ÿä¿¡æ¯è„±æ• â€” å›¾ç‰‡æ–‡å­—ä¸€é”®é®æŒ¡">
    <meta property="og:description" content="ä¸€é”®é®æŒ¡å›¾ç‰‡ä¸­çš„éšç§æ•°æ®ã€‚100%æœ¬åœ°å¤„ç†ã€‚">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <script type="application/ld+json">
    { "@context":"https://schema.org","@type":"WebApplication","name":"æ•æ„Ÿä¿¡æ¯è„±æ•","applicationCategory":"UtilitiesApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"CNY"},"featureList":["å›¾ç‰‡æ‰“ç ","æ–‡å­—é®æŒ¡","çŸ©å½¢é©¬èµ›å…‹","éšç§ä¿æŠ¤","æœ¬åœ°å¤„ç†"] }
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y4N0TE83KD"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments) } gtag('js', new Date()); gtag('config', 'G-Y4N0TE83KD');</script>
    <link rel="stylesheet" href="../../shared/style.css">
    <link rel="stylesheet" href="../../shared/donate.css">
    <style>
        .tool-area {
            max-width: 900px;
            margin: 0 auto;
        }

        .upload-zone {
            border: 2px dashed var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 3rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            background: rgba(99, 102, 241, 0.03);
        }

        .upload-zone:hover,
        .upload-zone.drag-over {
            border-color: var(--brand-primary);
            background: rgba(99, 102, 241, 0.08);
        }

        .upload-zone .icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .canvas-wrapper {
            position: relative;
            display: inline-block;
            max-width: 100%;
            margin: 0 auto;
        }

        .canvas-wrapper canvas {
            display: block;
            max-width: 100%;
            cursor: crosshair;
            border-radius: var(--radius-md);
        }

        .toolbar {
            display: flex;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            margin-bottom: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .toolbar label {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .color-pick {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            padding: 0;
        }

        .mode-chips {
            display: flex;
            gap: 0.5rem;
        }

        .mode-chip {
            padding: 0.4rem 0.8rem;
            border-radius: 100px;
            border: 1px solid var(--border-subtle);
            cursor: pointer;
            font-size: 0.8rem;
            background: transparent;
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .mode-chip.active {
            background: var(--brand-primary);
            color: #fff;
            border-color: var(--brand-primary);
        }

        .privacy-banner {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.25rem;
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: var(--radius-md);
            margin-bottom: 2rem;
        }

        .privacy-banner .shield-icon {
            font-size: 1.5rem;
        }

        .privacy-banner p {
            font-size: 0.85rem;
            color: #34d399;
            margin: 0;
        }

        .action-bar {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        #fileInput {
            display: none;
        }

        .preview-area {
            text-align: center;
        }
    </style>
</head>

<body>
    <header class="site-header">
        <div class="header-inner">
            <a href="../../../index.html" class="logo"><span class="logo-icon">ğŸ§°</span> ToolBox</a>
            <nav class="header-nav"><a href="../../../index.html">é¦–é¡µ</a><a href="../id-watermark/index.html">èº«ä»½è¯æ°´å°</a><a
                    href="../exif-remove/index.html">EXIFæ¸…é™¤</a></nav>
        </div>
    </header>

    <main class="main-content">
        <section class="tool-hero">
            <span class="badge badge-privacy">ğŸ›¡ï¸ 100% æœ¬åœ°å¤„ç†</span>
            <h1>æ•æ„Ÿä¿¡æ¯è„±æ•</h1>
            <p class="subtitle">åœ¨å›¾ç‰‡ä¸Šæ¡†é€‰åŒºåŸŸï¼Œä¸€é”®é®æŒ¡éšç§ä¿¡æ¯<br>æ”¯æŒçº¯è‰²é®æŒ¡å’Œé©¬èµ›å…‹æ¨¡å¼</p>
        </section>
        <div class="privacy-banner"><span class="shield-icon">ğŸ”’</span>
            <p><strong>éšç§æ‰¿è¯ºï¼š</strong>æ‰€æœ‰å¤„ç†å‡åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œ<strong>å›¾ç‰‡ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨</strong>ã€‚</p>
        </div>

        <div class="tool-area">
            <div class="card">
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="fileInput" accept="image/*">
                    <span class="icon">ğŸ”’</span>
                    <p style="font-size:0.9rem;"><strong>ç‚¹å‡»é€‰æ‹©æˆ–æ‹–å…¥éœ€è¦è„±æ•çš„å›¾ç‰‡</strong></p>
                </div>

                <div id="editorArea" style="display:none;">
                    <div class="toolbar">
                        <label>é®æŒ¡æ¨¡å¼ï¼š</label>
                        <div class="mode-chips" id="modeChips">
                            <button class="mode-chip active" data-mode="solid">â–  çº¯è‰²</button>
                            <button class="mode-chip" data-mode="mosaic">â–¦ é©¬èµ›å…‹</button>
                            <button class="mode-chip" data-mode="blur">â—‰ æ¨¡ç³Š</button>
                        </div>
                        <label style="margin-left:auto;">é¢œè‰²ï¼š</label>
                        <input type="color" id="colorPick" value="#000000" class="color-pick" aria-label="é®æŒ¡é¢œè‰²">
                    </div>
                    <p style="font-size:0.75rem;color:var(--text-muted);margin-bottom:0.75rem;text-align:center;">ğŸ–±ï¸
                        åœ¨å›¾ç‰‡ä¸Šæ‹–æ‹½æ¡†é€‰è¦é®æŒ¡çš„åŒºåŸŸã€‚å¯å¤šæ¬¡æ“ä½œã€‚</p>
                    <div class="preview-area">
                        <div class="canvas-wrapper">
                            <canvas id="canvas"></canvas>
                        </div>
                    </div>
                </div>

                <div class="action-bar">
                    <button class="btn btn-secondary" id="undoBtn" disabled>â†© æ’¤é”€</button>
                    <button class="btn btn-secondary" id="resetBtn" disabled>ğŸ”„ é‡æ–°é€‰æ‹©</button>
                    <button class="btn btn-primary" id="downloadBtn" disabled aria-label="ä¸‹è½½è„±æ•å›¾ç‰‡">ğŸ’¾ ä¸‹è½½è„±æ•å›¾ç‰‡</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <p>ToolBox â€” å…è´¹åœ¨çº¿å·¥å…·åˆé›† Â· 100% æµè§ˆå™¨æœ¬åœ°å¤„ç† Â· <a href="../../../index.html">è¿”å›é¦–é¡µ</a></p>
    </footer>
    <div class="toast" id="toast"></div>

    <script>
        (function () {
            'use strict';
            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');
            const editorArea = document.getElementById('editorArea');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const modeChips = document.getElementById('modeChips');
            const colorPick = document.getElementById('colorPick');
            const undoBtn = document.getElementById('undoBtn');
            const resetBtn = document.getElementById('resetBtn');
            const downloadBtn = document.getElementById('downloadBtn');

            let img = null, mode = 'solid', history = [], drawing = false, startX, startY;

            uploadZone.onclick = () => fileInput.click();
            uploadZone.ondragover = e => { e.preventDefault(); uploadZone.classList.add('drag-over'); };
            uploadZone.ondragleave = () => uploadZone.classList.remove('drag-over');
            uploadZone.ondrop = e => { e.preventDefault(); uploadZone.classList.remove('drag-over'); loadImage(e.dataTransfer.files[0]); };
            fileInput.onchange = e => loadImage(e.target.files[0]);
            resetBtn.onclick = () => location.reload();

            modeChips.onclick = e => {
                const chip = e.target.closest('.mode-chip');
                if (!chip) return;
                document.querySelectorAll('.mode-chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                mode = chip.dataset.mode;
            };

            undoBtn.onclick = () => {
                if (history.length <= 1) return;
                history.pop();
                const imgData = history[history.length - 1];
                ctx.putImageData(imgData, 0, 0);
                undoBtn.disabled = history.length <= 1;
            };

            downloadBtn.onclick = () => {
                const a = document.createElement('a');
                a.href = canvas.toDataURL('image/png');
                a.download = `redacted_${Date.now()}.png`;
                a.click();
                showToast('âœ… å·²ä¸‹è½½è„±æ•å›¾ç‰‡');
                if (typeof ToolBoxDonate !== 'undefined') ToolBoxDonate.showThankYou();
            };

            function loadImage(file) {
                if (!file || !file.type.startsWith('image/')) { showToast('âš ï¸ è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶'); return; }
                img = new Image();
                img.onload = () => {
                    canvas.width = img.naturalWidth;
                    canvas.height = img.naturalHeight;
                    ctx.drawImage(img, 0, 0);
                    history = [ctx.getImageData(0, 0, canvas.width, canvas.height)];
                    editorArea.style.display = 'block';
                    uploadZone.style.display = 'none';
                    downloadBtn.disabled = false;
                    resetBtn.disabled = false;
                };
                img.src = URL.createObjectURL(file);
            }

            canvas.onmousedown = e => {
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                startX = (e.clientX - rect.left) * (canvas.width / rect.width);
                startY = (e.clientY - rect.top) * (canvas.height / rect.height);
            };

            canvas.onmousemove = e => {
                if (!drawing) return;
                const rect = canvas.getBoundingClientRect();
                const curX = (e.clientX - rect.left) * (canvas.width / rect.width);
                const curY = (e.clientY - rect.top) * (canvas.height / rect.height);
                ctx.putImageData(history[history.length - 1], 0, 0);
                ctx.strokeStyle = '#ef4444';
                ctx.lineWidth = 2;
                ctx.setLineDash([6, 3]);
                ctx.strokeRect(startX, startY, curX - startX, curY - startY);
                ctx.setLineDash([]);
            };

            canvas.onmouseup = e => {
                if (!drawing) return;
                drawing = false;
                const rect = canvas.getBoundingClientRect();
                const endX = (e.clientX - rect.left) * (canvas.width / rect.width);
                const endY = (e.clientY - rect.top) * (canvas.height / rect.height);
                const x = Math.min(startX, endX), y = Math.min(startY, endY);
                const w = Math.abs(endX - startX), h = Math.abs(endY - startY);
                if (w < 5 || h < 5) return;
                ctx.putImageData(history[history.length - 1], 0, 0);

                if (mode === 'solid') {
                    ctx.fillStyle = colorPick.value;
                    ctx.fillRect(x, y, w, h);
                } else if (mode === 'mosaic') {
                    applyMosaic(x, y, w, h, 12);
                } else if (mode === 'blur') {
                    applyBlur(x, y, w, h);
                }
                history.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
                undoBtn.disabled = false;
            };

            canvas.addEventListener('touchstart', e => { e.preventDefault(); const t = e.touches[0]; canvas.onmousedown({ clientX: t.clientX, clientY: t.clientY }); });
            canvas.addEventListener('touchmove', e => { e.preventDefault(); const t = e.touches[0]; canvas.onmousemove({ clientX: t.clientX, clientY: t.clientY }); });
            canvas.addEventListener('touchend', e => { e.preventDefault(); const t = e.changedTouches[0]; canvas.onmouseup({ clientX: t.clientX, clientY: t.clientY }); });

            function applyMosaic(x, y, w, h, blockSize) {
                const imgData = ctx.getImageData(x, y, w, h);
                const d = imgData.data;
                for (let by = 0; by < h; by += blockSize) {
                    for (let bx = 0; bx < w; bx += blockSize) {
                        let r = 0, g = 0, b = 0, count = 0;
                        for (let dy = 0; dy < blockSize && by + dy < h; dy++) {
                            for (let dx = 0; dx < blockSize && bx + dx < w; dx++) {
                                const idx = ((by + dy) * w + bx + dx) * 4;
                                r += d[idx]; g += d[idx + 1]; b += d[idx + 2]; count++;
                            }
                        }
                        r = r / count | 0; g = g / count | 0; b = b / count | 0;
                        for (let dy = 0; dy < blockSize && by + dy < h; dy++) {
                            for (let dx = 0; dx < blockSize && bx + dx < w; dx++) {
                                const idx = ((by + dy) * w + bx + dx) * 4;
                                d[idx] = r; d[idx + 1] = g; d[idx + 2] = b;
                            }
                        }
                    }
                }
                ctx.putImageData(imgData, x, y);
            }

            function applyBlur(x, y, w, h) {
                ctx.save();
                ctx.beginPath(); ctx.rect(x, y, w, h); ctx.clip();
                for (let i = 0; i < 8; i++) ctx.drawImage(canvas, x, y, w, h, x - 2, y - 2, w + 4, h + 4);
                ctx.restore();
            }

            function showToast(msg) { const t = document.getElementById('toast'); t.textContent = msg; t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2500); }
        })();
    </script>
    <script src="../../shared/donate.js"></script>
</body>

</html>