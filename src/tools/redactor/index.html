<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataGuard â€” æ•æ„Ÿä¿¡æ¯è„±æ•å™¨ | ToolBox</title>
    <meta name="description" content="å…è´¹åœ¨çº¿æ•æ„Ÿä¿¡æ¯è„±æ•å·¥å…·ã€‚è‡ªåŠ¨è¯†åˆ«å¹¶é®ç›–å§“åã€æ‰‹æœºå·ã€èº«ä»½è¯ã€é‚®ç®±ã€é“¶è¡Œå¡å·ã€‚æ•°æ®ä¸å‡ºæµè§ˆå™¨ï¼Œ100%æœ¬åœ°å¤„ç†ã€‚">
    <meta name="keywords" content="æ•æ„Ÿä¿¡æ¯è„±æ•,æ•°æ®è„±æ•,éšç§ä¿æŠ¤,æ‰‹æœºå·é®ç›–,èº«ä»½è¯è„±æ•,DataGuard,åœ¨çº¿è„±æ•å·¥å…·">
    <link rel="canonical" href="https://1426013249.github.io/toolbox/src/tools/redactor/index.html">
    <!-- Open Graph -->
    <meta property="og:title" content="DataGuard â€” æ•æ„Ÿä¿¡æ¯è„±æ•å™¨">
    <meta property="og:description" content="è‡ªåŠ¨è¯†åˆ«å¹¶è„±æ•æ‰‹æœºå·ã€èº«ä»½è¯ã€é‚®ç®±ã€é“¶è¡Œå¡ç­‰æ•æ„Ÿä¿¡æ¯ã€‚100% æœ¬åœ°å¤„ç†ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://1426013249.github.io/toolbox/src/tools/redactor/index.html">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="DataGuard â€” æ•æ„Ÿä¿¡æ¯è„±æ•å™¨">
    <meta name="twitter:description" content="è‡ªåŠ¨æ£€æµ‹å¹¶è„±æ• 8 ç§æ•æ„Ÿä¿¡æ¯ï¼Œå…è´¹åœ¨çº¿éšç§ä¿æŠ¤å·¥å…·ã€‚">
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "DataGuard æ•æ„Ÿä¿¡æ¯è„±æ•å™¨",
      "url": "https://1426013249.github.io/toolbox/src/tools/redactor/index.html",
      "description": "å…è´¹åœ¨çº¿æ•æ„Ÿä¿¡æ¯è„±æ•å·¥å…·ï¼Œè‡ªåŠ¨è¯†åˆ« 8 ç§æ•æ„Ÿæ•°æ®",
      "applicationCategory": "SecurityApplication",
      "operatingSystem": "Any",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "CNY" },
      "featureList": ["æ‰‹æœºå·è„±æ•", "èº«ä»½è¯è„±æ•", "é‚®ç®±è„±æ•", "é“¶è¡Œå¡è„±æ•", "IPåœ°å€è„±æ•", "100% æœ¬åœ°å¤„ç†"]
    }
    </script>
    <link rel="stylesheet" href="../../shared/style.css">
    <style>
        .tool-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 900px) {
            .tool-area {
                grid-template-columns: 1fr;
            }
        }

        .text-input {
            width: 100%;
            min-height: 300px;
            padding: 1rem;
            background: var(--bg-input);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            line-height: 1.8;
            resize: vertical;
            outline: none;
        }

        .text-input:focus {
            border-color: var(--brand-primary);
        }

        .output-box {
            width: 100%;
            min-height: 300px;
            padding: 1rem;
            background: var(--bg-input);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-y: auto;
        }

        .redacted {
            background: #1e1e2e;
            color: #1e1e2e;
            border-radius: 3px;
            padding: 0 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .redacted:hover {
            background: var(--brand-primary);
            color: white;
        }

        .redacted.revealed {
            background: rgba(244, 63, 94, 0.2);
            color: var(--brand-accent);
        }

        .stats-bar {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 0.75rem;
        }

        .stat-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.25rem 0.6rem;
            border-radius: 100px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--border-subtle);
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .stat-chip strong {
            color: var(--brand-primary-light);
        }

        .pattern-toggles {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .pattern-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.3rem 0.7rem;
            border-radius: 100px;
            font-size: 0.78rem;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            user-select: none;
        }

        .pattern-tag.active {
            background: rgba(99, 102, 241, 0.15);
            border-color: var(--brand-primary);
            color: var(--brand-primary-light);
        }

        .pattern-tag:hover {
            border-color: var(--border-hover);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.25rem;
            margin-top: 3rem;
        }

        .feature-card {
            padding: 1.25rem;
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .feature-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(99, 102, 241, 0.1);
            border-radius: var(--radius-sm);
        }

        .feature-card h3 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .feature-card p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }
    </style>
</head>

<body>
    <header class="site-header">
        <div class="header-inner">
            <a href="../../../index.html" class="logo">
                <div class="logo-icon">ğŸ§°</div><span>ToolBox</span>
            </a>
            <nav class="header-nav"><a href="../../../index.html">å…¨éƒ¨å·¥å…·</a></nav>
        </div>
    </header>

    <main class="main-content">
        <section class="tool-hero">
            <span class="badge badge-privacy">ğŸ”’ æ•°æ® 100% æœ¬åœ°å¤„ç†ï¼Œä¸ä¸Šä¼ æœåŠ¡å™¨</span>
            <h1>DataGuard</h1>
            <p class="subtitle">è‡ªåŠ¨è¯†åˆ«å¹¶è„±æ•æ–‡æœ¬ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚æ”¯æŒæ‰‹æœºå·ã€èº«ä»½è¯ã€é‚®ç®±ã€é“¶è¡Œå¡ã€å§“åç­‰ã€‚ç‚¹å‡»é®ç›–åŒºåŸŸå¯ä¸´æ—¶æŸ¥çœ‹åŸæ–‡ã€‚</p>
        </section>

        <section>
            <div class="card" style="margin-bottom:1rem">
                <label>æ£€æµ‹è§„åˆ™</label>
                <div class="pattern-toggles" id="pattern-toggles"></div>
            </div>

            <div class="tool-area">
                <div>
                    <div class="card">
                        <label for="input-text">è¾“å…¥æ–‡æœ¬</label>
                        <textarea id="input-text" class="text-input"
                            placeholder="ç²˜è´´éœ€è¦è„±æ•çš„æ–‡æœ¬...&#10;&#10;ç¤ºä¾‹ï¼š&#10;å¼ ä¸‰çš„æ‰‹æœºå·æ˜¯ 13812345678ï¼Œèº«ä»½è¯å· 110101199001011234ï¼Œé‚®ç®± zhangsan@example.comï¼Œé“¶è¡Œå¡å· 6222021234567890123ã€‚">å¼ ä¸‰çš„æ‰‹æœºå·æ˜¯ 13812345678ï¼Œèº«ä»½è¯å· 110101199001011234ï¼Œé‚®ç®± zhangsan@example.comï¼Œé“¶è¡Œå¡å· 6222021234567890123ã€‚
æå››åœ¨åŒ—äº¬å¸‚æœé˜³åŒºå·¥ä½œï¼Œç”µè¯ 021-87654321ï¼ŒIP åœ°å€ 192.168.1.100ã€‚
å…¬å¸ç¨å·ï¼š91110000MA12345678</textarea>
                    </div>
                    <div class="action-bar" style="display:flex;gap:0.75rem;margin-top:0.75rem">
                        <button class="btn btn-primary" id="btn-redact" style="flex:1;justify-content:center">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                            </svg>
                            å¼€å§‹è„±æ•
                        </button>
                        <button class="btn btn-secondary" id="btn-copy" style="flex:1;justify-content:center">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" />
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                            </svg>
                            å¤åˆ¶ç»“æœ
                        </button>
                    </div>
                </div>

                <div>
                    <div class="card">
                        <label>è„±æ•ç»“æœ <span id="stats-inline"
                                style="font-weight:400;text-transform:none;letter-spacing:0"></span></label>
                        <div class="output-box" id="output-box">ç‚¹å‡»"å¼€å§‹è„±æ•"æŒ‰é’®æŸ¥çœ‹ç»“æœ...</div>
                    </div>
                    <div class="stats-bar" id="stats-bar"></div>
                </div>
            </div>
        </section>

        <section class="features-grid">
            <div class="card feature-card">
                <div class="feature-icon">ğŸ”’</div>
                <div>
                    <h3>100% æœ¬åœ°å¤„ç†</h3>
                    <p>æ‰€æœ‰æ•°æ®å¤„ç†åœ¨ä½ çš„æµè§ˆå™¨å†…å®Œæˆã€‚æ–­ç½‘ä¹Ÿèƒ½ç”¨ï¼Œç»ä¸ä¸Šä¼ ä»»ä½•æ•°æ®ã€‚</p>
                </div>
            </div>
            <div class="card feature-card">
                <div class="feature-icon">ğŸ¯</div>
                <div>
                    <h3>æ™ºèƒ½è¯†åˆ«</h3>
                    <p>è‡ªåŠ¨æ£€æµ‹æ‰‹æœºå·ã€èº«ä»½è¯ã€é‚®ç®±ã€é“¶è¡Œå¡ã€IP åœ°å€ç­‰ 8 ç§æ•æ„Ÿä¿¡æ¯ã€‚</p>
                </div>
            </div>
            <div class="card feature-card">
                <div class="feature-icon">ğŸ‘ï¸</div>
                <div>
                    <h3>å¯é€†æŸ¥çœ‹</h3>
                    <p>ç‚¹å‡»é®ç›–åŒºåŸŸå¯ä¸´æ—¶æŸ¥çœ‹åŸå§‹å†…å®¹ï¼Œæ–¹ä¾¿æ ¸å¯¹ã€‚</p>
                </div>
            </div>
            <div class="card feature-card">
                <div class="feature-icon">âš¡</div>
                <div>
                    <h3>å³æ—¶å¤„ç†</h3>
                    <p>æ— éœ€ç­‰å¾…ä¸Šä¼ ä¸‹è½½ï¼Œç²˜è´´å³å‡ºç»“æœã€‚æ”¯æŒå¤§æ®µæ–‡æœ¬ã€‚</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <p>ToolBox â€” å…è´¹ã€å®‰å…¨ã€å¥½ç”¨çš„åœ¨çº¿å·¥å…·åˆé›†</p>
        <p style="margin-top:0.3rem">Made with â¤ï¸ by <a href="../../../index.html">ToolBox</a></p>
    </footer>

    <div class="toast" id="toast"></div>

    <script>
        (function () {
            'use strict';

            // ---- Pattern definitions ----
            const PATTERNS = [
                { id: 'phone', label: 'ğŸ“± æ‰‹æœºå·', regex: /1[3-9]\d{9}/g, mask: (m) => m.slice(0, 3) + '****' + m.slice(7) },
                { id: 'idcard', label: 'ğŸªª èº«ä»½è¯', regex: /[1-9]\d{5}(19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]/g, mask: (m) => m.slice(0, 6) + '****' + m.slice(-4) },
                { id: 'email', label: 'ğŸ“§ é‚®ç®±', regex: /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g, mask: (m) => m[0] + '***@' + m.split('@')[1] },
                { id: 'bankcard', label: 'ğŸ’³ é“¶è¡Œå¡', regex: /[456]\d{15,18}/g, mask: (m) => m.slice(0, 4) + ' **** **** ' + m.slice(-4) },
                { id: 'landline', label: 'ğŸ“ åº§æœº', regex: /0\d{2,3}-\d{7,8}/g, mask: (m) => m.split('-')[0] + '-****' + m.slice(-3) },
                { id: 'ip', label: 'ğŸŒ IPåœ°å€', regex: /\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\b/g, mask: () => '***.***.***.***' },
                { id: 'taxid', label: 'ğŸ¢ ç¨å·', regex: /[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/g, mask: (m) => m.slice(0, 4) + '****' + m.slice(-4) },
                { id: 'name_cn', label: 'ğŸ‘¤ ä¸­æ–‡å§“å', regex: /[\u4e00-\u9fa5]{2,4}/g, mask: (m) => m[0] + '*'.repeat(m.length - 1), enabled: false },
            ];

            let activePatterns = new Set(PATTERNS.filter(p => p.enabled !== false).map(p => p.id));

            // ---- Init Pattern Toggles ----
            const togglesEl = document.getElementById('pattern-toggles');
            PATTERNS.forEach(p => {
                const tag = document.createElement('span');
                tag.className = 'pattern-tag' + (activePatterns.has(p.id) ? ' active' : '');
                tag.textContent = p.label;
                tag.addEventListener('click', () => {
                    if (activePatterns.has(p.id)) { activePatterns.delete(p.id); tag.classList.remove('active'); }
                    else { activePatterns.add(p.id); tag.classList.add('active'); }
                });
                togglesEl.appendChild(tag);
            });

            // ---- Redact Logic ----
            function redact(text) {
                const matches = [];
                const active = PATTERNS.filter(p => activePatterns.has(p.id));

                // Collect all match ranges
                active.forEach(pattern => {
                    const re = new RegExp(pattern.regex.source, pattern.regex.flags);
                    let m;
                    while ((m = re.exec(text)) !== null) {
                        // Skip Chinese name pattern for very common words
                        if (pattern.id === 'name_cn' && m[0].length < 2) continue;
                        matches.push({ start: m.index, end: m.index + m[0].length, original: m[0], masked: pattern.mask(m[0]), type: pattern.id });
                    }
                });

                // Sort by position, remove overlaps
                matches.sort((a, b) => a.start - b.start);
                const filtered = [];
                let lastEnd = -1;
                matches.forEach(m => {
                    if (m.start >= lastEnd) { filtered.push(m); lastEnd = m.end; }
                });

                // Build output HTML
                let html = '';
                let cursor = 0;
                filtered.forEach(m => {
                    html += escapeHtml(text.slice(cursor, m.start));
                    html += `<span class="redacted" data-original="${escapeAttr(m.original)}" title="ç‚¹å‡»æŸ¥çœ‹åŸæ–‡ (${m.type})">${escapeHtml(m.masked)}</span>`;
                    cursor = m.end;
                });
                html += escapeHtml(text.slice(cursor));

                return { html, count: filtered.length, byType: countByType(filtered) };
            }

            function countByType(matches) {
                const c = {};
                matches.forEach(m => { c[m.type] = (c[m.type] || 0) + 1; });
                return c;
            }

            function escapeHtml(s) { return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br>'); }
            function escapeAttr(s) { return s.replace(/"/g, '&quot;').replace(/'/g, '&#39;'); }

            // ---- DOM Bindings ----
            const inputEl = document.getElementById('input-text');
            const outputEl = document.getElementById('output-box');
            const statsInline = document.getElementById('stats-inline');
            const statsBar = document.getElementById('stats-bar');

            document.getElementById('btn-redact').addEventListener('click', () => {
                const text = inputEl.value;
                if (!text.trim()) { showToast('è¯·å…ˆè¾“å…¥æ–‡æœ¬'); return; }
                const result = redact(text);
                outputEl.innerHTML = result.html;
                statsInline.textContent = `â€” å…±å‘ç° ${result.count} å¤„æ•æ„Ÿä¿¡æ¯`;

                // Stats chips
                const labels = { phone: 'æ‰‹æœºå·', idcard: 'èº«ä»½è¯', email: 'é‚®ç®±', bankcard: 'é“¶è¡Œå¡', landline: 'åº§æœº', ip: 'IP', taxid: 'ç¨å·', name_cn: 'å§“å' };
                statsBar.innerHTML = Object.entries(result.byType).map(([k, v]) => `<span class="stat-chip"><strong>${v}</strong> ${labels[k] || k}</span>`).join('');

                // Click to reveal
                outputEl.querySelectorAll('.redacted').forEach(el => {
                    el.addEventListener('click', () => {
                        if (el.classList.contains('revealed')) {
                            el.textContent = el.dataset.masked || el.textContent;
                            el.classList.remove('revealed');
                        } else {
                            el.dataset.masked = el.textContent;
                            el.textContent = el.dataset.original;
                            el.classList.add('revealed');
                        }
                    });
                });
            });

            document.getElementById('btn-copy').addEventListener('click', async () => {
                const text = outputEl.innerText;
                if (!text || text.includes('ç‚¹å‡»')) { showToast('è¯·å…ˆæ‰§è¡Œè„±æ•'); return; }
                try { await navigator.clipboard.writeText(text); showToast('âœ… å·²å¤åˆ¶çº¯æ–‡æœ¬ç»“æœ'); }
                catch { showToast('âš ï¸ å¤åˆ¶å¤±è´¥'); }
            });

            function showToast(msg) {
                const t = document.getElementById('toast'); t.textContent = msg;
                t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2000);
            }
        })();
    </script>
</body>

</html>