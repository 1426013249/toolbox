<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹å†™ç­¾åè½¬é€æ˜ PNG â€” è‡ªåŠ¨æŠ å›¾ã€ç”µå­ç­¾ååˆ¶ä½œå·¥å…· | ToolBox</title>
    <meta name="description" content="å…è´¹åœ¨çº¿æ‰‹å†™ç­¾åèƒŒæ™¯ç§»é™¤å·¥å…·ã€‚ä¸€é”®å°†çº¸å¼ ä¸Šçš„æ‰‹å†™ç­¾åè½¬æ¢ä¸ºé€æ˜èƒŒæ™¯ PNGï¼Œæ”¯æŒé¢œè‰²å¢å¼ºã€åè‰²åŠç¬”è¿¹æ¢è‰²ã€‚100%æµè§ˆå™¨æœ¬åœ°å¤„ç†ï¼Œä¿æŠ¤æ‚¨çš„ç­¾åéšç§ã€‚">
    <meta name="keywords" content="æ‰‹å†™ç­¾åæŠ å›¾,é€æ˜ç­¾åç”Ÿæˆ,ç”µå­ç­¾ååˆ¶ä½œ,ç­¾åèƒŒæ™¯å»é™¤,ç¬”è¿¹æå–,é€æ˜PNGå·¥å…·,æœ¬åœ°å¤„ç†">
    <link rel="canonical" href="https://toolbox-smoky.vercel.app/src/tools/signature-to-png/index.html">
    <!-- Open Graph -->
    <meta property="og:title" content="æ‰‹å†™ç­¾åè½¬é€æ˜ PNG â€” è‡ªåŠ¨æŠ å›¾å·¥å…·">
    <meta property="og:description" content="ä¸€é”®å°†ç™½çº¸ä¸Šçš„ç­¾åè½¬æ¢ä¸ºé€æ˜ PNGã€‚æ”¯æŒé¢œè‰²æ›¿æ¢ä¸ç»†èŠ‚å¢å¼ºï¼Œ100% æœ¬åœ°å¤„ç†ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://toolbox-smoky.vercel.app/src/tools/signature-to-png/index.html">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="æ‰‹å†™ç­¾åè½¬é€æ˜ PNG â€” è‡ªåŠ¨æŠ å›¾å·¥å…·">
    <meta name="twitter:description" content="å…è´¹åœ¨çº¿ç­¾åæŠ å›¾å·¥å…·ï¼Œæœ¬åœ°å¤„ç†ï¼Œä¸ä¸Šä¼ ä»»ä½•æ•°æ®ã€‚">
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "æ‰‹å†™ç­¾åè½¬é€æ˜ PNG",
      "url": "https://toolbox-smoky.vercel.app/src/tools/signature-to-png/index.html",
      "description": "ä¸€é”®å°†çº¸è´¨ç­¾åè½¬æ¢ä¸ºé€æ˜ PNG ç”µå­ç­¾åï¼Œæ”¯æŒæœ¬åœ°å¤„ç†",
      "applicationCategory": "DesignApplication",
      "operatingSystem": "Any",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "CNY" },
      "featureList": ["èƒŒæ™¯è‡ªåŠ¨ç§»é™¤", "é€æ˜ PNG å¯¼å‡º", "é¢œè‰²æ›¿æ¢", "ç¬”è¿¹å¢å¼º", "æœ¬åœ°å¤„ç†"]
    }
    </script>
    <!-- GA4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y4N0TE83KD"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments) } gtag('js', new Date()); gtag('config', 'G-Y4N0TE83KD');</script>
    <link rel="stylesheet" href="../../shared/style.css">
    <link rel="stylesheet" href="../../shared/donate.css">
    <style>
        /* ---- Tool-specific styles ---- */
        .tool-area {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 2rem;
            align-items: start;
        }

        @media (max-width: 1024px) {
            .tool-area {
                grid-template-columns: 1fr;
            }
        }

        /* Upload zone */
        .upload-zone {
            border: 2px dashed var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 2rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            background: rgba(99, 102, 241, 0.03);
            position: relative;
        }

        .upload-zone:hover {
            border-color: var(--brand-primary);
            background: rgba(99, 102, 241, 0.08);
        }

        .upload-zone .icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        /* Settings panel */
        .settings-group {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .setting-item label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .setting-item .value-display {
            color: var(--brand-primary-light);
            font-family: monospace;
        }

        /* Comparison Preview */
        .preview-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            min-height: 400px;
        }

        @media (max-width: 640px) {
            .preview-container {
                grid-template-columns: 1fr;
            }
        }

        .preview-box {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .preview-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .canvas-wrapper {
            position: relative;
            flex: 1;
            min-height: 300px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            /* Checkerboard for transparency */
            background-image:
                linear-gradient(45deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%),
                linear-gradient(-45deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, rgba(0, 0, 0, 0.05) 75%),
                linear-gradient(-45deg, transparent 75%, rgba(0, 0, 0, 0.05) 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        .canvas-wrapper.original {
            background-image: none;
            background: var(--bg-input);
        }

        .canvas-wrapper canvas,
        .canvas-wrapper img {
            max-width: 100%;
            max-height: 500px;
            object-fit: contain;
        }

        /* Control Toggles */
        .toggle-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .toggle-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            user-select: none;
            font-size: 0.85rem;
        }

        .toggle-item input {
            cursor: pointer;
        }

        /* Color selection */
        .color-chips {
            display: flex;
            gap: 0.5rem;
        }

        .color-chip {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 2px solid var(--border-subtle);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .color-chip.active {
            border-color: var(--brand-primary);
            transform: scale(1.1);
        }

        /* Action bar */
        .action-bar {
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        /* Privacy banner */
        .privacy-banner {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.25rem;
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: var(--radius-md);
            margin-bottom: 2rem;
        }

        .privacy-banner .shield-icon {
            font-size: 1.5rem;
        }

        .privacy-banner p {
            font-size: 0.85rem;
            color: #34d399;
            margin: 0;
        }

        #fileInput {
            display: none;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-inner">
            <a href="../../../index.html" class="logo">
                <span class="logo-icon">ğŸ§°</span> ToolBox
            </a>
            <nav class="header-nav">
                <a href="../../../index.html">é¦–é¡µ</a>
                <a href="../pdf/index.html">PDFå·¥å…·</a>
                <a href="../image/index.html">å›¾åƒå¤„ç†</a>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <!-- Hero -->
        <section class="tool-hero">
            <span class="badge badge-privacy">ğŸ›¡ï¸ ç¦»çº¿å¤„ç† Â· ä¿æŠ¤éšç§</span>
            <h1>æ‰‹å†™ç­¾åè½¬é€æ˜ PNG</h1>
            <p class="subtitle">
                è‡ªåŠ¨å»é™¤ç™½çº¸åº•è‰²ï¼Œæå–çº¯å‡€çš„æ‰‹å†™ç¬”è¿¹<br>
                è®©æ‚¨çš„çº¸è´¨ç­¾åç¬é—´å˜ä¸ºé«˜æ¸…ã€é€æ˜çš„ç”µå­ç­¾å
            </p>
        </section>

        <!-- Privacy Banner -->
        <div class="privacy-banner">
            <span class="shield-icon">ğŸ”’</span>
            <p><strong>éšç§å£°æ˜ï¼š</strong>æ‰€æœ‰å›¾ç‰‡å¤„ç†å‡åœ¨æ‚¨çš„æµè§ˆå™¨æœ¬åœ°æ‰§è¡Œã€‚æ‚¨çš„ç­¾åå›¾ç‰‡<strong>ä¸ä¼š</strong>è¢«ä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ï¼Œå¤„ç†å®Œæˆååˆ·æ–°é¡µé¢å³å®Œå…¨é”€æ¯ã€‚</p>
        </div>

        <div class="tool-area">
            <!-- Sidebar: Controls -->
            <div class="card">
                <div class="settings-group">
                    <!-- Upload -->
                    <div class="setting-item">
                        <label>ä¸Šä¼ ç­¾åç…§ç‰‡</label>
                        <div class="upload-zone" id="uploadZone">
                            <input type="file" id="fileInput" accept="image/*">
                            <span class="icon">âœï¸</span>
                            <p style="font-size:0.9rem;"><strong>ç‚¹å‡»é€‰æ‹©æˆ–æ‹–å…¥ç…§ç‰‡</strong></p>
                            <p style="font-size:0.75rem; color:var(--text-muted); margin-top:0.25rem;">æ”¯æŒ JPG, PNG, WEBP
                            </p>
                        </div>
                    </div>

                    <!-- Threshold -->
                    <div class="setting-item">
                        <label>
                            <span>èƒŒæ™¯ç§»é™¤é˜ˆå€¼</span>
                            <span class="value-display" id="thresholdValue">150</span>
                        </label>
                        <input type="range" id="thresholdSlider" min="0" max="255" value="150" aria-label="èƒŒæ™¯ç§»é™¤é˜ˆå€¼">
                        <p style="font-size:0.7rem; color:var(--text-muted);">æ•°å€¼è¶Šå¤§ä¿ç•™çš„ç¬”è¿¹è¶Šå¤šï¼Œæ•°å€¼è¶Šå°èƒŒæ™¯å»é™¤è¶Šå¹²å‡€</p>
                    </div>

                    <!-- Options -->
                    <div class="setting-item">
                        <label>å¢å¼ºé€‰é¡¹</label>
                        <div class="toggle-group">
                            <label class="toggle-item">
                                <input type="checkbox" id="invertCheck" aria-label="åè‰²å¤„ç†">
                                <span>åè‰² (é»‘ç™½äº’æ¢)</span>
                            </label>
                            <label class="toggle-item">
                                <input type="checkbox" id="enhanceCheck" checked aria-label="ç¬”è¿¹å¢å¼º">
                                <span>ç¬”è¿¹å¢å¼º</span>
                            </label>
                        </div>
                    </div>

                    <!-- Color Replacement -->
                    <div class="setting-item">
                        <label>ç¬”è¿¹é¢œè‰²æ›¿æ¢</label>
                        <div class="color-chips" id="colorChips">
                            <div class="color-chip active" data-color="original"
                                style="background: transparent; display:flex; align-items:center; justify-content:center; font-size:10px; border-style:dashed;"
                                title="ä¿æŒåŸè‰²">åŸ</div>
                            <div class="color-chip" data-color="#000000" style="background: #000000;" title="é»‘è‰²"></div>
                            <div class="color-chip" data-color="#0033ff" style="background: #0033ff;" title="è“è‰²"></div>
                            <div class="color-chip" data-color="#ff0000" style="background: #ff0000;" title="çº¢è‰²"></div>
                            <div class="color-chip" data-color="#ffffff" style="background: #ffffff;" title="ç™½è‰²"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main: Preview -->
            <div class="card">
                <div class="preview-container">
                    <div class="preview-box">
                        <div class="preview-label">ğŸ“¸ åŸå§‹å›¾ç‰‡</div>
                        <div class="canvas-wrapper original">
                            <img id="originalImg" style="display:none;" alt="åŸå§‹ç­¾åé¢„è§ˆ">
                            <div id="uploadHint" style="color:var(--text-muted); font-size:0.9rem;">æš‚æ— å›¾ç‰‡</div>
                        </div>
                    </div>
                    <div class="preview-box">
                        <div class="preview-label">âœ¨ é€æ˜ç»“æœ (æ£‹ç›˜æ ¼åŒºåŸŸä¸ºé€æ˜)</div>
                        <div class="canvas-wrapper">
                            <canvas id="resultCanvas" style="display:none;"></canvas>
                            <div id="resultHint" style="color:var(--text-muted); font-size:0.9rem;">ç­‰å¾…å¤„ç†</div>
                        </div>
                    </div>
                </div>

                <div class="action-bar">
                    <button class="btn btn-secondary" id="resetBtn" disabled>ğŸ”„ é‡ç½®</button>
                    <button class="btn btn-primary" id="downloadBtn" disabled aria-label="ä¸‹è½½é€æ˜ç­¾å">ğŸ’¾ ä¸‹è½½é€æ˜ PNG</button>
                </div>
            </div>
        </div>

        <!-- Guide -->
        <section style="margin-top:3rem; border-top:1px solid var(--border-subtle); padding-top:2rem;">
            <h2 style="font-size:1.25rem; margin-bottom:1.5rem; text-align:center;">å¦‚ä½•è·å¾—æœ€ä½³æ•ˆæœï¼Ÿ</h2>
            <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:1.5rem;">
                <div class="card" style="padding:1.25rem;">
                    <h3 style="font-size:1rem; margin-bottom:0.5rem; color:var(--brand-primary-light);">1. æ‹ç…§æŠ€å·§</h3>
                    <p style="font-size:0.85rem; color:var(--text-secondary);">åœ¨å…‰çº¿å……è¶³çš„åœ°æ–¹æ‹æ‘„ï¼Œé¿å…é˜´å½±è¦†ç›–ç¬”è¿¹ã€‚å°½é‡åœ¨å¹³æ•´çš„çº¯ç™½çº¸ä¸Šä¹¦å†™ã€‚</p>
                </div>
                <div class="card" style="padding:1.25rem;">
                    <h3 style="font-size:1rem; margin-bottom:0.5rem; color:var(--brand-primary-light);">2. è°ƒæ•´é˜ˆå€¼</h3>
                    <p style="font-size:0.85rem; color:var(--text-secondary);">å¦‚æœèƒŒæ™¯æ²¡å»å¹²å‡€ï¼Œå°è¯•å‡å°é˜ˆå€¼ï¼›å¦‚æœç¬”è¿¹å˜æ·¡æˆ–æ–­è£‚ï¼Œè¯·å¢åŠ é˜ˆå€¼ã€‚</p>
                </div>
                <div class="card" style="padding:1.25rem;">
                    <h3 style="font-size:1rem; margin-bottom:0.5rem; color:var(--brand-primary-light);">3. é¢œè‰²å¢å¼º</h3>
                    <p style="font-size:0.85rem; color:var(--text-secondary);">å¼€å¯"ç¬”è¿¹å¢å¼º"å¯ä»¥è‡ªåŠ¨åŠ æ·±æµ…è‰²çš„ç¬”ç”»ï¼Œè®©ç”µå­ç­¾åæ›´æ¸…æ™°ã€‚</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <p>ToolBox â€” æç®€ã€å®‰å…¨çš„æµè§ˆå™¨æœ¬åœ°å·¥å…·é›† Â· <a href="../../../index.html">è¿”å›é¦–é¡µ</a></p>
    </footer>

    <div class="toast" id="toast"></div>

    <script>
        (function () {
            'use strict';

            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');
            const originalImg = document.getElementById('originalImg');
            const resultCanvas = document.getElementById('resultCanvas');
            const ctx = resultCanvas.getContext('2d');

            const thresholdSlider = document.getElementById('thresholdSlider');
            const thresholdValue = document.getElementById('thresholdValue');
            const invertCheck = document.getElementById('invertCheck');
            const enhanceCheck = document.getElementById('enhanceCheck');
            const downloadBtn = document.getElementById('downloadBtn');
            const resetBtn = document.getElementById('resetBtn');
            const uploadHint = document.getElementById('uploadHint');
            const resultHint = document.getElementById('resultHint');
            const colorChips = document.getElementById('colorChips');

            let sourceImage = null;
            let targetColor = 'original';

            // ---- Events ----
            uploadZone.onclick = () => fileInput.click();
            fileInput.onchange = (e) => handleFile(e.target.files[0]);

            uploadZone.ondragover = (e) => { e.preventDefault(); uploadZone.style.borderColor = 'var(--brand-primary)'; };
            uploadZone.ondragleave = () => { uploadZone.style.borderColor = ''; };
            uploadZone.ondrop = (e) => {
                e.preventDefault();
                uploadZone.style.borderColor = '';
                handleFile(e.dataTransfer.files[0]);
            };

            thresholdSlider.oninput = () => {
                thresholdValue.textContent = thresholdSlider.value;
                process();
            };

            invertCheck.onchange = process;
            enhanceCheck.onchange = process;

            colorChips.onclick = (e) => {
                const chip = e.target.closest('.color-chip');
                if (!chip) return;
                document.querySelectorAll('.color-chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                targetColor = chip.dataset.color;
                process();
            };

            resetBtn.onclick = () => location.reload();

            downloadBtn.onclick = () => {
                const link = document.createElement('a');
                link.download = `signature_${Date.now()}.png`;
                link.href = resultCanvas.toDataURL('image/png');
                link.click();
                showToast('âœ… å·²å¯¼å‡ºé€æ˜ç­¾å PNG');
                if (typeof ToolBoxDonate !== 'undefined') ToolBoxDonate.showThankYou();
            };

            // ---- Core Logic ----
            function handleFile(file) {
                if (!file || !file.type.startsWith('image/')) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        sourceImage = img;
                        originalImg.src = img.src;
                        originalImg.style.display = 'block';
                        uploadHint.style.display = 'none';
                        resultCanvas.style.display = 'block';
                        resultHint.style.display = 'none';

                        downloadBtn.disabled = false;
                        resetBtn.disabled = false;

                        process();
                        showToast('âœ… å›¾ç‰‡åŠ è½½æˆåŠŸ');
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            function process() {
                if (!sourceImage) return;

                const w = sourceImage.naturalWidth;
                const h = sourceImage.naturalHeight;
                resultCanvas.width = w;
                resultCanvas.height = h;

                // Draw to get pixel data
                ctx.drawImage(sourceImage, 0, 0);
                const imageData = ctx.getImageData(0, 0, w, h);
                const data = imageData.data;

                const threshold = parseInt(thresholdSlider.value);
                const invert = invertCheck.checked;
                const enhance = enhanceCheck.checked;

                // Parse target color
                let rT, gT, bT;
                if (targetColor !== 'original') {
                    rT = parseInt(targetColor.slice(1, 3), 16);
                    gT = parseInt(targetColor.slice(3, 5), 16);
                    bT = parseInt(targetColor.slice(5, 7), 16);
                }

                for (let i = 0; i < data.length; i += 4) {
                    let r = data[i];
                    let g = data[i + 1];
                    let b = data[i + 2];

                    // Luminance (BT.709)
                    const lum = 0.2126 * r + 0.7152 * g + 0.0722 * b;

                    // Background detection
                    if (lum > threshold) {
                        data[i + 3] = 0; // Transparent
                    } else {
                        // It's a stroke
                        let alpha = 255;

                        // Optional smoothing: fade alpha near threshold
                        if (lum > threshold - 20) {
                            alpha = 255 * (threshold - lum) / 20;
                        }

                        data[i + 3] = alpha;

                        // Color handling
                        if (targetColor !== 'original') {
                            data[i] = rT;
                            data[i + 1] = gT;
                            data[i + 2] = bT;
                        } else if (enhance) {
                            // Boost contrast for original color
                            // Map [0, threshold] to [0, 255] inversely
                            const factor = 255 / threshold;
                            data[i] = Math.max(0, r * factor - 50);
                            data[i + 1] = Math.max(0, g * factor - 50);
                            data[i + 2] = Math.max(0, b * factor - 50);
                        }

                        // Invert
                        if (invert) {
                            data[i] = 255 - data[i];
                            data[i + 1] = 255 - data[i + 1];
                            data[i + 2] = 255 - data[i + 2];
                        }
                    }
                }

                ctx.putImageData(imageData, 0, 0);
            }

            function showToast(msg) {
                const toast = document.getElementById('toast');
                toast.textContent = msg;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            }
        })();
    </script>
    <script src="../../shared/donate.js"></script>
</body>

</html>